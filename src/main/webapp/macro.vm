#macro(basichead $showdesc $showkeyw)
	#if ($IN_PRODUCTION)
		#set($slink = $CDN_URL)
		#set($ilink = $CDN_URL)
		#set($minsuffix = "-min")
	#else
		#set($slink = "$context/styles")
		#set($ilink = "$context/images")
		#set($minsuffix = "")
	#end
	<title>$APPNAME $!title </title>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
	<link href="$ilink/logosq.png" rel="image_src"/>
	<link href="$ilink/logosq.png" rel="apple-touch-icon"/>
	<link href="$ilink/favicon.ico" rel="shortcut icon"/>
	<link href="$slink/style$!{minsuffix}.css" rel="stylesheet" type="text/css" media="screen"/>
	#if ($showdesc && !$showdesc.isEmpty())
		<meta name="description" content="$showdesc"/>
	#end
	#if ($showkeyw && !$showkeyw.isEmpty())
		<meta name="keywords" content="$showkeyw"/>
	#end
	<meta property="fb:app_id" content="99517177417" />
#end
################# DEFINE MACROS ################################################
#macro(renderSpecialFields $clickform)
${clickform.fields.form_name}
#foreach ($field in $clickform.fieldList)
#if ($field.name.contains("SUBMIT_CHECK")) $field #end
#end
#end
#####################################
#macro(getcontactlinkcode $showcontact)
#if ($showcontact)
#if ($showcontact.value.startsWith("http://") || $showcontact.value.startsWith("https://") || $showcontact.value.startsWith("www."))
<a href="$showcontact.value" class="extlink" rel="no-follow">$!showcontact.value</a>
#else $!showcontact.value #end#end#end
################# COMMENTS MACROS #####################
#macro(newcommentform $parentid $hidden $uri)
#if ($uri == "")
#set($thisuri = $request.getAttribute('javax.servlet.forward.request_uri'))
#if ($request.getAttribute('javax.servlet.forward.query_string'))
#set($thisuri = "$!{thisuri}?$!request.getAttribute('javax.servlet.forward.query_string')")
#end
#else
#set($thisuri = $uri)
#end

#if ($hidden) #set($hide = "hide") #else	#set($hide = "") #end
<div class="newcommentform mvm ${hide}">
	<form method="post" class="new-comment-form" action="${thisuri}">
		<fieldset>
			#sectoken(false)
			<div class="line">
				<div class="unit size4of5">
					<textarea rows="2" cols="4" class="p100 nicebox" name="comment"></textarea>
					<input type="hidden" name="parentid" value="$!parentid"/>
					<input type="hidden" name="getcommenthtmlcode" value="true"/>
				</div>
				<div class="unit size1of5  center">
					<input type="submit" value="$!lang.get('add')" class="btn waves-effect waves-light new-comment-btn"/>
				</div>
			</div>
		</fieldset>
	</form>
</div>
#end
###########################################
#macro(commentbox $showcomment)
#set($thisuri = $request.getAttribute('javax.servlet.forward.request_uri'))
#if ($request.getAttribute('javax.servlet.forward.query_string'))
#set($thisuri = "$!{thisuri}?$!request.getAttribute('javax.servlet.forward.query_string')")
#end
#if ($thisuri.contains("?"))	#set($amp = "&amp;") #else #set($amp = "?") #end

#if ($showcomment == "")	#set($hide = "hide") #else #set($hide = "")	#end
<div class="commentbox pas ${hide}">
	#if ($showcomment.hidden)
	#set($hidden = "hide")
	<span>$!lang.get("comments.hidden") &nbsp;</span>
	<a href="#" title="$!lang.get('comments.show')" class="show-comment">$!lang.get("comments.show")</a>
	#else
	#set($hidden = "noclass")
	#end

	<div class="${hidden}">
		<div class="left">
			<span class="lightgray pictos">w</span>
			#set($commentAuthor = {'name': $!showcomment.author, 'id': $showcomment.creatorid})
			<span class="comment-author">#personlink($commentAuthor):</span>&nbsp;
			<span class="comment-text">$!showcomment.comment</span>
		</div>
		<div class="right">
			<span class="comment-timestamp mrs"><span class="pictos">t</span> #formatdate($showcomment.timestamp '')</span>
			#votebox($showcomment "mrs")
			#if ($showcomment == "")
			#getreportlink($showcomment "$commentlink/$!showcomment.id" "chip notext")
			<a href="${thisuri}" title="$!lang.get('delete')" class="red delete-comment pictos">D</a>
			#elseif ($authenticated && ($showcomment.creatorid == $authUser.id || $request.isUserInRole("mod")))
			<a href="${thisuri}${amp}deletecomment=$!showcomment.id" title="$!lang.get('delete')" class="red delete-comment pictos">D</a>
			#else
			#getreportlink($showcomment "$commentlink/$!showcomment.id" "chip notext")
			#end
		</div>
	</div>
</div>
#end
####################################
#macro(commentspage $comments)
#foreach($comment in $comments)
#commentbox($comment)
#end
#commentbox("") ## empty box to be cloned
#end
####################################
#macro(commentspagepreview $comments $count)
#if ($comments)
#if ($comments.size() > $count)
#set($countmo = $count - 1 )
#foreach($c in [0..$countmo])
#commentbox($comments.get($c))
#end

#if ($comments.size() > $count)
<a href="#" class="more-comments-btn chip">$!lang.get("more")</a>
<div class="hide">
	#set($countmo = $comments.size() - 1 )
	#foreach($c in [$count..$countmo])
	#commentbox($comments.get($c))
	#end
</div>
#end
#else
#foreach($comment in $comments)
#commentbox($comment)
#end
#end
#end
#commentbox("") ## empty box to be cloned
#end
################# QUESTIONS MACROS #####################
#macro(newquestionform $_form $hidden $type)
#set($thisuri = $request.getAttribute('javax.servlet.forward.request_uri'))

#if ($hidden) #set($hide = "hide") #else #set($hide = "") #end
#if ($type.equalsIgnoreCase("question"))
<h2>
	<a href="$questionslink">$!lang.get("questions.title")</a> / $!lang.get("posts.ask")
</h2>
#elseif ($type.equalsIgnoreCase("feedback"))
<h2><a href="$feedbacklink">$!lang.get("feedback.title")</a> / $!lang.get("feedback.write")</h2>
#end
<hr />
<div id="questionform" class="qform ${hide}">
	<form method="post" id="$_form.id" action="$thisuri">
		#if ($_form.error)
		#getmessagebox("errorBox" $_form.error false)
		#end
		<fieldset>
			#sectoken(false)
			#renderSpecialFields($_form)
			<div class="hide">Leave blank:</div>${_form.fields.additional}
			<input type="hidden" name="ask" value="true"/>
			#createformfield(${_form.fields.parentid} "nicebox p50")
			#createformfield(${_form.fields.title} "nicebox p98")
			#createformfield(${_form.fields.body} "edit-post nicebox p98 nicebox hidelabel")
			<div class="edit-preview"></div>
			#createformfield(${_form.fields.tags} "tagbox nicebox p98")

			<div class="center mtl">
				${_form.fields.askbtn} &nbsp; <a href="$!actionlink" class="btn waves-effect waves-light">$!lang.get('cancel')</a>
			</div>
		</fieldset>
	</form>
</div>
#end
###########################################
#macro(newanswerform $_form $showpost $hidden)
#set($thisuri = $request.getAttribute('javax.servlet.forward.request_uri'))

#if ($hidden) #set($hide = "hide") #else #set($hide = "noclass") #end
<div class="${hide}">
	<form method="post" id="$_form.id" action="$thisuri">
		#if ($_form.error)
		#getmessagebox("errorBox" $_form.error false)
		#end
		<fieldset>
			#sectoken(false)
			#if ($showpost.isQuestion())
			<legend>$!lang.get("posts.youranswer")</legend>
			#else
			<legend>$!lang.get("feedback.writereply")</legend>
			#end
			#renderSpecialFields($_form)
			<input type="hidden" name="answer" value="true"/>
			<div class="hide">Leave blank:</div>${_form.fields.additional}
			<ol>
				<li>
					#createformfield(${_form.fields.body} "hidelabel edit-post unload-confirm p99 nicebox")
					<div class="edit-preview"></div>
				</li>
			</ol>

			<div class="center">
				${_form.fields.answerbtn}
				<input type="button" value="$!lang.get('close')" class="btn waves-effect waves-light close-answer-form"/>
			</div>
		</fieldset>
	</form>
</div>
#end
###########################################
#macro(tagsbox $tags $link)
#foreach($showtag in $tags)
#if ($showtag && $showtag.trim() != "")
#if (!$link || $link.isEmpty())
<span class="chip mrs">
	<span class="pictos">z</span> $!showtag
</span>
#else
<a href="$link/tag/$!utils.urlEncode($showtag)" title="Posts tagged $!showtag" class="chip mrs">
	<span class="pictos">z</span> $!showtag
</a>
#end
#end
#end
#end
################# PAGINATION #####################
#macro(paginate $page $macroCode $count $params $mode)
#if ($pagenum && $pagenum.longValue() > 10000) #set($next = $page) #else #set($next = $page + 1) #end
#set($requri = $request.getAttribute("javax.servlet.forward.request_uri"))
#set($classes = "pagelink btn waves-effect waves-light")
#if ($params && !$params.isEmpty()) #set($reqURL = "$requri?${params}&amp;page") #else #set($reqURL = "$requri?page") #end

<div class="page-content">#evaluate($macroCode)</div>
#if ($count && $count > $MAX_ITEMS_PER_PAGE && $macroCode && !$macroCode.trim().isEmpty())
<div class="pages center mtl">
	#if ($mode == "pageless") #set($classes = "$classes more-link" ) #else #set($classes = "$classes more-link-na" ) #end
	<a href="$reqURL=$!next" class="more-link-na ${classes}" title="Load more">$!lang.get("more")</a>
	<span class="hide page-macro-code">$!macroCode</span>
</div>
#end
#end
####################################
#macro(contactsjs $contacts )#foreach($contact in $contacts) {id:"$contact.id", name:"$contact.name"}#if ($velocityCount < $contactslist.size()),#end#end#end
####################################
#macro(personbox $showFriend)
#if ($showFriend)
<div class="whitebox media">
	<div class="img mrl center">
		<a href="$profilelink/$showFriend.id/#stripstr($showFriend.name)">
			<img src="#profilepic($showFriend)" width="50" height="50" alt="Profile thumbnail"/>
		</a>
	</div>
	<div class="bd">
		<div class="line lightgray">
			<div class="unit size1of2">$!{lang.get($showFriend.type)}</div>
			<div class="unit size1of2  r">
				#usertitlebadge($showFriend)
			</div>
		</div>
		<div class="line">
			<div class="unit size3of4">
				<div class="mediumText mbs">
					<span class="chip reputationbox" title="$!lang.get('reputation')">$utils.abbreviateInt($!showFriend.votes, 0)</span>
					<a href="$profilelink/${showFriend.id}/#stripstr($!showFriend.name)">$!{showFriend.name}</a>
				</div>
				#if ($showFriend.status && !$showFriend.status.isEmpty())
				<div>$!{showFriend.status}</div>
				#end
			</div>
			<div class="unit size1of4  r">
				#if (!$authenticated || ($authenticated && $showFriend.id != $authUser.id))
					#getreportlink($showFriend "$profilelink/$showFriend.id" "chip notext")
				#end
			</div>
		</div>
	</div>
</div>
#end
#end
####################################
#macro(smallpersonbox $showu)
<div class="userbox media pas user-$!{showu.id}">
	<div class="img mrm center">
		#if ($showu)
		<a href="$profilelink/$!showu.creatorid/#stripstr($!showu.name)" title="$!showu.name">
			<img src="#profilepic($!showu)" width="50" height="50" alt="Profile picture"/>
		</a>
		#else
		<img src="#profilepic($!showu)" width="50" height="50" alt="Profile picture"/>
		#end
	</div>
	<div class="bd">
		#if ($showu)
		<a href="$profilelink/$!showu.creatorid/#stripstr($!showu.name)" class="smallText">$showu.name</a>
		#else
		$!lang.get("profile.deleted")
		#end
		#if ($showu)
		<br />
		<span class="chip reputationbox">$!utils.abbreviateInt($!showu.votes, 0)</span>
		<span class="lightgray">#usertitlebadge($showu)</span>
		#end
	</div>
</div>
#end
####################################
#macro(tinypersonbox $showu)
<div>
	#if ($showu)
	<a href="$profilelink/$!showu.creatorid/#stripstr($!showu.name)" title="$!showu.name [$!showu.votes]">
		<img src="#profilepic($!showu)" width="40" height="40" alt="Profile picture"/>
	</a>
	#else
	<img src="#profilepic($!showu)" width="40" height="40" alt="Profile picture"/>
	#end
</div>
#end
####################################
#macro(inactivepersonbox $showname $showclass)
<div class="userbox media pas">
	<div class="img mrm center">
		<img src="https://www.gravatar.com/avatar/?size=50&amp;d=mm&amp;r=pg" width="50" height="50" alt="Profile picture"/>
	</div>
	<div class="bd">
		<div class="smallText">
			$!showname
		</div>
	</div>
</div>
#end
####################################
#macro(personlink $showu)
<span>
	#if ($showu.groups && !$showu.groups.isEmpty())
	#if ($showu.groups == "mods")
	<span class="pictos" title="$!lang.get('mod')">S</span>
	#elseif ($showu.groups == "admins")
	<span class="pictos" title="$!APPNAME developer">b</span>
	<span class="pictos" title="$!lang.get('mod')">S</span>
	#else
	<span class="pictos">U</span>
	#end
	#end
	#if ($showu)
	#if ($showu.name)
	#set($seopsuffix = "/#stripstr($!showu.name)" )
	#else
	#set($seopsuffix = "" )
	#end
	<a href="$profilelink/$!{showu.id}$!{seosuffix}" title="Go to profile">$!showu.name</a>
	#else
	$!lang.get("profile.deleted")
	#end
</span>
#end
####################################
#macro(peoplepage $people)
#foreach($showFriend in $people)
#personbox($showFriend)
#end
#end
####################################
#macro(getreportlink $reportable $link $clazz)
#if ($reportable)
#set($requri = $request.getAttribute("javax.servlet.forward.request_uri"))
#set($href = "${requri}?getreportform=true&amp;parentid=$!reportable.id&amp;parentid=$!reportable.id&amp;type=$!reportable.class.getSimpleName()")
#if (!$link.isEmpty())
#set($encodedLink = $utils.urlEncode($link))
#set($href = "${href}&amp;link=$encodedLink")
#end
#if ($reportable.parentid && !$reportable.parentid.isEmpty())
#set($href = "${href}&amp;grandparentid=$reportable.parentid")
#end
#if ($clazz.contains("notext")) #set($showtxt = "" ) #else #set($showtxt = " $!lang.get('report')") #end
<a href="$!{href}" title="Report a problem" class="trigger-report $!{clazz}"><span class="fa fa-flag"></span>$showtxt</a>
#end
#end
####################################
#macro(questionspage $posts )
#foreach($post in $posts)
#questionbox($post)
#end
#end
####################################
#macro(questionbox $showpost )
#set($actionlink = "#getpostlink($showpost false true)")
#set($actionlink2 = "#getpostlink($showpost true true)")

<div class="questionbox whitebox">
	<div class="right mlm center">
		#set($author = $showpost.author)
		#tinypersonbox($author)
		<div class="smallText lightgray">
			<span class="pictos">t</span>
			#formatdate($showpost.timestamp "")
		</div>
		#if (!$authenticated || ($authenticated && $showpost.creatorid != $authUser.id))
		#getreportlink($showpost "$questionlink/$!showpost.id" "chip notext")
		#end
	</div>
	<div class="media">
		#set($votes = $showpost.votes)
		#set($viewcount = $showpost.viewcount)
		#set($answercount = $showpost.answercount)

		#if (!$votes) #set($votes = 0) #end
		#if (!$viewcount) #set($viewcount = 0) #end
		#if (!$answercount) #set($answercount = 0) #end

		<div class="img">
			#if ($showpost.answerid) #set($bgclass = "lightbluebg" ) #else #set($bgclass = "" ) #end
			<div class="qstatsbox mrl pas center $!{bgclass}">
				<div class="largeText" title="$!lang.get('votes')">$!utils.abbreviateInt($!votes, 0)</div>
				<div class="line">
					<div class="unit size1of2" title="$!lang.get('answers.title')">$utils.abbreviateInt($!answercount, 0)</div>
					<div class="unit size1of2 " title="$!lang.get('posts.views')">$utils.abbreviateInt($!viewcount, 0)</div>
				</div>
			</div>
		</div>
		<div class="bd">
			#if ($showpost.deleteme)
			<span class="pictos red" title="$!lang.get('posts.marked')">#</span>
			#end
			<a href="$!actionlink/$showpost.id/#stripstr($!showpost.title)" class="mediumText">$!showpost.title</a>

			#set($showBody = $utils.stripHtml($utils.markdownToHtml($showpost.body)) )
			<div>$!utils.abbreviate($showBody, 160)</div>
			<div>#tagsbox($showpost.tags $actionlink2)</div>
		</div>
	</div>
</div>
#end
####################################
#macro(answerspage $answers $parentpost)
#foreach($answer in $answers)
#postbox($answer $parentpost)
#end
#end
####################################
#macro(compactanswerspage $answers)
#foreach($answer in $answers)
#answerbox($answer)
#end
#end
####################################
#macro(answerbox $showpost )
<div class="questionbox whitebox">
	<div class="right p">
		<span class="pictos">t</span> #formatdate($showpost.timestamp "")
	</div>
	<div class="p100">
		#set($votes = $showpost.votes)
		#if (!$votes) #set($votes = 0) #end

		<span class="chip reputationbox mediumText mrl">$!votes</span>
		<span class="p70">
			<a href="$questionlink/$showpost.parentid#post-$!showpost.id" title="View answer">
				$!utils.abbreviate($showpost.body, 100).replaceAll('\s', ' ')
			</a>
		</span>
	</div>
</div>
#end
####################################
#macro(postbox $showpost $parentpost)
#if ($showpost.isReply())	#set($boxclass = "whitebox") #else #set($boxclass = "" ) #end

#set($actionlink = "#getpostlink($showpost false true)")
#set($actionlink2 = "#getpostlink($showpost true true)")

<div class="p100 postbox ${boxclass}">
	<div class="mbm">
		#if ($canEdit)
		<a href="#" title="Edit" class="editlink chip"><span class="pictos">W</span> $!lang.get("edit")</a>
		#end

		#if ($canComment)
		<a href="#" class="next-div-toggle chip" title="Add a comment"><span class="pictos">w</span> $!lang.get("comments.write")</a>
		#end

		#if ($showpost.lasteditby)
		<a href="$!postlink/$showpost.id/revisions" title="Revision history" class="chip"><span class="pictos">l</span> $!lang.get("revisions.title")</a>
		#end

		#if ($isMine || $request.isUserInRole("mod"))
		<a href="$!actionlink/$showpost.id/delete" class="post-refresh-ask chip" title="Delete"><span class="pictos">*</span> $!lang.get("delete")</a>
		#end

		#if ($request.isUserInRole("mod") && $showpost.isQuestion())
		#if ($showPost.isClosed())
		<a href="$!actionlink/$showpost.id/close" title="Reopen" class="post-refresh chip"><span class="pictos">)</span> $!lang.get("reopen")</a>
		#else
		<a href="$!actionlink/$showpost.id/close" title="Close" class="post-refresh-ask chip"><span class="pictos">(</span> $!lang.get("close")</a>
		#end
		#end

		#if ($request.isUserInRole("admin"))
		<a href="${adminlink}?delete=post&amp;id=$showpost.id" title="Delete" class="chip red"><span class="pictos">*</span> $!lang.get("delete")</a>
		#end

		#if (!$authenticated || ($authenticated && $showpost.creatorid != $authUser.id))
		#getreportlink($showpost "$questionlink/$!showpost.id" "chip")
		#end

		#if ($canComment)
		#newcommentform($showpost.id true "$questionlink/$showpost.id")
		#end
	</div>

	<div class="line lightgraybg prs plm pts">
		<div class="unit size1of2">
			#votebox($showpost "hugeText mtm mrl")
			<span class="right mtm">
				#set($approvedAnswer = $showpost.id.equals($parentpost.answerid) )
				#if ($approvedAnswer)
				#set($onclass = "green")
				#set($picon = "2")
				#else
				#set($onclass = "")
				#set($picon = "3")
				#end
				#if ($authenticated && $showpost.isReply() && $parentpost.creatorid.equals($authUser.id))
				<a href="$!actionlink/$parentpost.id/approve/$showpost.id" class="megaText pictos approve-answer nodecoration $!{onclass}" title="Approve answer">$picon</a>
				#elseif ($approvedAnswer)
				<span class="pictos megaText green">$picon</span>
				#end
			</span>
		</div>
		<div class="unit size1of2  r">
			#set($author = $showpost.author)
			#smallpersonbox($author)
		</div>
	</div>

	<div id="post-$!showpost.id" class="viewbox mbm">
		<div class="mbl pas">
			#set($_bodyHtml = $utils.markdownToHtml("$!showpost.body"))
			$!{_bodyHtml}

			#if ($showpost.tags && !$showpost.tags.isEmpty())
			<div class="mtm">#tagsbox($showpost.tags $actionlink2)</div>
			#end
		</div>

		#if ($showpost.lasteditby)
		<div class="line">
			<div class="unit size1of3">
				<span class="pictos">p</span>
				<strong>$!lang.get("posts.posted")</strong>
				<span class="pictos">t</span> #formatdate($showpost.timestamp "")
			</div>
			<div class="unit size2of3  r">
				#if ($showpost.lasteditby)
				<span class="pictos">W</span>
				<strong>
					<a href="$postlink/$showpost.id/revisions" title="Revision history">$!lang.get("posts.editby")</a>
				</strong>
				#personlink($showpost.lastEditor) <span class="pictos">t</span> #formatdate($showpost.lastactivity "")
				#end
			</div>
		</div>
		#end
	</div>
	#if ($canEdit)
	<div class="editbox lightgraybg pam hide">
		#set($_form = $showpost.editForm)
		#if ($_form)
		#set($editLink = $request.getAttribute("javax.servlet.forward.request_uri"))
		<form method="post" id="$_form.id" action="$editLink">
			#if ($_form.error)
			#getmessagebox("errorBox" $_form.error false)
			#end
			<fieldset>
				#sectoken(false)
				#renderSpecialFields($_form)
				<input type="hidden" name="editpostid" value="$showpost.id"/>
				<div class="hide">Leave blank:</div>${_form.fields.additional}
				#createformfield(${_form.fields.body} "hidelabel edit-post nicebox p99")
				<div class="edit-preview"></div>
				#createformfield(${_form.fields.tags} "tagbox nicebox p99")

				<div class="center mtl">
					${_form.fields.editbtn}
					<input type="button" value="$!lang.get('close')" class="btn waves-effect waves-light canceledit"/>
				</div>
			</fieldset>
		</form>
		#end
	</div>
	#end

	<div class="comments post-comments">
		#if ($showpost && $showpost.commentcount > 0)
		#paginate($showpost.pagenum.longValue() "\#commentspagepreview(\$showpost.comments 2)" $showpost.commentcount "getcomments=true&amp;parentid=$showpost.id" "pageless")
		#end
	</div>
</div>
#end
###################################
#macro(translationspage $translations $approvedmap)
#foreach($trans in $translations)
#set($approved = $approvedmap.containsKey($trans.key) && $approvedmap.get($trans.key).equals($trans.id))
#translationbox($trans $approved)
#end
#end
###################################
#macro(translationbox $showtrans $approved)
#set($timestamp = "#formatdate($showtrans.timestamp '')")
#set($thisuri = $request.getAttribute('javax.servlet.forward.request_uri'))

<div class="translationbox media">
	<div class="img mrm">
		#if ($request.isUserInRole("admin"))
		#if ($approved)
		#set($onclass = "green")
		#set($picon = "2")
		#else
		#set($onclass = "")
		#set($picon = "3")
		#end
		<a href="${thisuri}?approve=$showtrans.id" class="approve-translation largeText pictos nodecoration $!{onclass}" title="Approve">$picon</a>
		&nbsp;
		#end
		#votebox($showtrans "mediumText")
	</div>
	<div class="bd pts">
		<div class="trans-value">$!showtrans.value</div>
		<div class="right">
			#set($translAuthor = $!showtrans.author)
			#personlink($translAuthor)
			<span class="trans-timestamp"><span class="pictos">t</span> $!timestamp</span>
			#if ($authenticated && ($showtrans.creatorid == $authUser.id || $request.isUserInRole("admin")))
			<a href="${thisuri}?delete=$!showtrans.id" title="Delete" class="delete-translation red chip"><span class="pictos">*</span></a>
			#else
			#getreportlink($showtrans "$translatelink/$!showtrans.id" "chip notext")
			#end
		</div>
	</div>
</div>
#end
###################################
#macro(langjs)
#set($jslang = ["areyousure","messages.sent","messages.to","profile.contacts.added","alumnus", "teacher",
"student","profile.status.txt","class.chat.userin",	"class.chat.userout","class.chat.connection.error",
"class.chat.polling.error","class.chat.reconnect.error", "more","posts.unloadconfirm",
"signup.form.error.required","signup.form.error.email","maxlength","minlength", "tags.toomany","close",
"save", "clickedit","invalidyear"])
{#foreach($!langkey in $jslang)"$!langkey":"$utils.escapeJavascript($!lang.get($!langkey))"#if ($velocityCount < $jslang.size()),#end #end}#end
###################################
#macro(langbox $showLangKey $showLangName $progress  )
#if ($showLangKey.equals($currentLocale.language)) #set($selclass = "selected-lang") #else #set($selclass = "") #end
<div class="mrl mbm center langbox ${selclass}">
	<div class="mediumText mbs">
		#if ($selclass == "")
		<form action="$languageslink" method="post">
			<fieldset>
				#sectoken(false)
				<input type="hidden" name="setlocale" value="$!showLangKey"/>
				<input type="submit" class="button-link capitalize" value="$showLangName"/>
			</fieldset>
		</form>
		#else
		<span class="capitalize">$!{showLangName}</span>
		#end
	</div>
	<div>
		#if ($progress >= 90) #set($gclass = "green" )#elseif ($progress >= 50)#set($gclass = "orange" )#else #set($gclass = "red" )#end
		<span class="chip reputationbox $!{gclass}" title="$!{progress}%">$!{progress}%</span>

		#if (!$showLangKey.equals("en"))
		<a href="$translatelink/$!showLangKey" title="$!{lang.get('translate.translate')}" class="chip">$!lang.get("translate.translate")</a>
		#end
	</div>
</div>
#end
###################################
#macro(badgebox $showbadge $num)
#set($badgeinfo = $!lang.get("about.badges.$showbadge") )
<span class="chip" title="$!badgeinfo">
	<span class="fa fa-star"></span>
	#if ($num && $num > 1) $!lang.get("$showbadge") <sup>$num</sup> #else $!lang.get("$showbadge") #end
</span>
#end
###################################
#macro(showcount $param )
#if ($param && $param > 1)
<span class="chip light-blue">$!param</span>
#end
#end
################# MISC MACROS #####################
#macro(votebox $votable $sizeClass)
#if ($votable)
#set($id = $!votable.id)
#set($type = $votable.type)
#if ($authenticated) #set($linkclass = "votelink") #else #set($linkclass = "") #end
#if ($votable.votes)	#set($votes = $votable.votes) #else #set($votes = 0) #end

<div class="votebox ${sizeClass}">
	#if ($votable && $authenticated && $votable.creatorid == $authUser.id)
	<span class="pictos downvote lightgray" title="Vote down">-</span>
	<span class="votecount">$!votes</span>
	<span class="pictos upvote lightgray" title="Vote up">+</span>
	#else
	<a href="$votedownlink/$!type/$!id" class="pictos downvote ${linkclass}" title="Vote down">-</a>
	<span class="votecount">$!votes</span>
	<a href="$voteuplink/$!type/$!id" class="pictos upvote ${linkclass}" title="Vote up">+</a>
	#end
</div>
#end
#end
#####################################
########### DELETE
########### DELETE
########### DELETE
#macro(createformfield $_field $class)
#if ($_field)
#if (!$class.isEmpty())  $_field.setAttribute("class", $class)  #end
#if ($_field.error) #set($hideme = "") #else  #set($hideme = "hide")  #end
#if ($class.contains("hintbox"))
$_field.setValue($!_field.label)
#elseif (!$class.contains("hidelabel") && !$_field.isHidden())
#if ($_field.label && !$_field.label.isEmpty()) <label class="blocklabel">$!{_field.label}: </label>#end
#end
<span class="error $!{hideme}">$!{_field.error}</span>
$!{_field}
#end
#end
########### DELETE
########### DELETE
########### DELETE
###################################
#macro(formvc $ctype)
<input type="hidden" name="vc" value="#$!{ctype}box(\$obj)"/>
#end
###################################
#macro(formvj $ctype $fields)
<input type="hidden" name="vj" value="$!{utils.getJSONValidationObject($ctype, $fields, $lang)}" disabled="disabled"/>
#end
#####################################
#macro(formatdate $date $format)
#if ($date && !$format.trim().isEmpty() && $format != "slim")
$utils.formatDate($date, $format, $currentLocale)
#elseif ($date)
#set($delta = $utils.timestamp() - $date)
#set($approxtime = $utils.humanTime.approximately($delta))
#if (!$approxtime || $approxtime.isEmpty()) #set($approxtime = "1s") #end
#set($lastindx = $approxtime.length() - 1 )
#set($suffix = $approxtime.substring($lastindx))
#set($approx = $approxtime.substring(0, $lastindx))
#set($sufstr = "humantime.$suffix" )
#if ($format == "slim")
$!utils.formatMessage($!lang.get($!sufstr), $!approx) [$utils.formatDate($date, 'dd MMMM yyyy, HH:mm', $currentLocale)]
#else
<span title="$utils.formatDate($date, 'dd MMMM yyyy, HH:mm', $currentLocale)">
	$!utils.formatMessage($!lang.get($!sufstr), $!approx)
</span>
#end
#end
#end
#####################################
#macro(reportform $type $parentid $grandparentid $parentid $link)
<form method="post" class="create-report-form" action="$context/?report=true">
	<fieldset>
		#sectoken(false)
		<legend><span class="pictos">^</span> $!lang.get("reportproblem")</legend>
		<label class="blocklabel">$!lang.get("reports.category")</label>
		<select class="nicebox p100" name="type">
			#foreach($type in $reportTypes)
			#if ($type.name() == "OTHER")
			<option selected="selected" value="$!type.name()">$!lang.get("reports.$type.toString()")</option>
			#else
			<option value="$!type.name()">$!lang.get("reports.$type.toString()")</option>
			#end
			#end
		</select>
		<label class="blocklabel">$!lang.get("reports.description")</label>
		<textarea class="p98 nicebox" cols="15" rows="5" name="description"></textarea>
		<input type="hidden" name="parentid" value="$!parentid"/>
		<input type="hidden" name="parentid" value="$!parentid"/>
		<input type="hidden" name="type" value="$!type"/>
		#if ($grandparentid && $grandparentid != "")
		<input type="hidden" name="grandparentid" value="$!grandparentid"/>
		#end
		#if ($link && !$link.isEmpty())
		<input type="hidden" name="link" value="$!link"/>
		#end
		<div class="center mtm">
			<input id="sendreport-btn" type="submit" value="$!lang.get('send')" class="btn waves-effect waves-light mrm"/>
			<input type="button" value="$!lang.get('close')" class="btn waves-effect waves-light jqmClose"/>
		</div>
	</fieldset>
</form>
#end
#####################################
#macro(getmessagebox $class $text $hidden)
#if ($hidden) #set($hideclass = "hide") #else #set($hideclass = "") #end
<div class="messagebox ${class} ${hideclass}" title="$!lang.get('click2close')">
	<div class="msg center">  #if ($text == "") &nbsp; #else $text #end  </div>
</div>
#end
#####################################
#macro(getpostlink $p $plural $noid)$p.getPostLink($plural,$noid,$questionslink,$questionlink,$feedbacklink)#end
#####################################
#macro(ajaxloading $hide)
#if ($hide) #set($hidden = "hide") #else #set($hidden = "") #end
<img src="data:image/gif;base64,R0lGODlhEAAQAPMAAP///wAAAAAAAIKCgnJycqioqLy8vM7Ozt7e3pSUlOjo6GhoaAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAAEKxDISau9OE/Bu//cQBTGgWDhWJ5XSpqoIL6s5a7xjLeyCvOgIEdDLBqPlAgAIfkECQoAAAAsAAAAABAAEAAABCsQyEmrvThPwbv/XJEMxIFg4VieV0qaqCC+rOWu8Yy3sgrzoCBHQywaj5QIACH5BAkKAAAALAAAAAAQABAAAAQrEMhJq704T8G7/9xhFMlAYOFYnldKmqggvqzlrvGMt7IK86AgR0MsGo+UCAAh+QQJCgAAACwAAAAAEAAQAAAEMRDISau9OE/Bu/+cghxGkQyEFY7lmVYraaKqIMpufbc0bLOzFyXGE25AyI5myWw6KREAIfkECQoAAAAsAAAAABAAEAAABDYQyEmrvThPwbv/nKQgh1EkA0GFwFie6SqIpImq29zWMC6xLlssR3vdZEWhDwBqejTQqHRKiQAAIfkECQoAAAAsAAAAABAAEAAABDYQyEmrvThPwbv/HKUgh1EkAyGF01ie6SqIpImqACu5dpzPrRoMpwPwhjLa6yYDOYuaqHRKjQAAIfkECQoAAAAsAAAAABAAEAAABDEQyEmrvThPwbv/nKUgh1EkAxFWY3mmK9WaqCqIJA3fbP7aOFctNpn9QEiPZslsOikRACH5BAkKAAAALAAAAAAQABAAAAQrEMhJq704T8G7/xymIIexEOE1lmdqrSYqiGTsVnA7q7VOszKQ8KYpGo/ICAAh+QQJCgAAACwAAAAAEAAQAAAEJhDISau9OE/Bu/+cthBDEmZjeWKpKYikC6svGq9XC+6e5v/AICUCACH5BAkKAAAALAAAAAAQABAAAAQrEMhJq704T8G7/xy2EENSGOE1lmdqrSYqiGTsVnA7q7VOszKQ8KYpGo/ICAAh+QQJCgAAACwAAAAAEAAQAAAEMRDISau9OE/Bu/+ctRBDUhgHElZjeaYr1ZqoKogkDd9s/to4Vy02mf1ASI9myWw6KREAIfkECQoAAAAsAAAAABAAEAAABDYQyEmrvThPwbv/HLUQQ1IYByKF01ie6SqIpImqACu5dpzPrRoMpwPwhjLa6yYDOYuaqHRKjQAAIfkECQoAAAAsAAAAABAAEAAABDYQyEmrvThPwbv/nLQQQ1IYB0KFwFie6SqIpImq29zWMC6xLlssR3vdZEWhDwBqejTQqHRKiQAAIfkECQoAAAAsAAAAABAAEAAABDEQyEmrvThPwbv/3EIMSWEciBWO5ZlWK2miqiDKbn23NGyzsxclxhNuQMiOZslsOikRADsAAAAAAAAAAAA=" width="16" height="16" alt="loading" class="ajaxwait vertcenter $!{hidden}"/>
#end
#####################################
#macro(profilepic $user)${user.picture}#end
#####################################
#macro(infostrip )
#if ($request.getParameter("success"))
#set($infoStripClass = "successBox" )
#elseif ($request.getParameter("error"))
#set($infoStripClass = "errorBox" )
#else
#set($infoStripClass = "infoBox" )
#end

#if ((!$infoStripMsg || $infoStripMsg.isEmpty()) && !$request.getParameter("code") && $badgelist.isEmpty())
#set($hideInfoStrip = "hide")
#else
#set($hideInfoStrip = "")
#end

#if ($infoStripMsg == "intro" && !$request.getParameter("code"))
#set($hideInfoStrip = "introBox" )
#set($infoStripMsg = "$!lang.get('about.intro') <a href='$aboutlink'>$!lang.get('learnmore')</a>" )
#set($infoStripClass = "" )
#elseif ($systemMessage && !$systemMessage.isEmpty())
#set($hideInfoStrip = "sysmsgBox" )
#set($infoStripMsg = $!systemMessage )
#set($infoStripClass = "infoBox blue" )
#end

<noscript>
<div class="infostrip errorBox pvm center">
	<span class="pictos ico errorBoxIcon $!{he}">!</span> $!{lang.get("nojavascript")}
</div>
</noscript>
<div class="infostrip center pvm ${hideInfoStrip} ${infoStripClass}" title="$!lang.get('close')">
	#set($hs = "hide" ) #set($he = "hide" ) #set($hi = "hide" )
	#if ($infoStripClass.contains("successBox"))
	#set($hs = "" )
	#elseif ($infoStripClass.contains("errorBox"))
	#set($he = "" )
	#elseif ($infoStripClass.contains("infoBox"))
	#set($hi = "" )
	#end
	<span class="pictos ico successBoxIcon $!{hs}">2</span>
	<span class="pictos ico errorBoxIcon $!{he}">!</span>
	<span class="pictos ico infoBoxIcon  $!{hi}">i</span>

	#set($_infoStripMsg = $infoStripMsg )

	<span class="infostrip-msg">
		#if (!$badgelist.isEmpty())
		#if ($badgelist.size() > 1) $!lang.get("newbadges") #else $!lang.get("newbadge") #end
		&nbsp;
		#foreach($badge in $badgelist)
		#badgebox($badge 0)
		#end
		#elseif ($request.getParameter("code"))
		$!lang.get("msgcode.${request.getParameter('code')}")
		#else
		$!_infoStripMsg
		#end
	</span>
</div>
#end
#####################################
#macro(stripstr $str )$!utils.urlEncode($!utils.noSpaces($str, "-"))#end
#####################################
#macro(usertitlebadge $showu)
#if ($showu.isModerator())
	#if ($showu.isAdmin())
	<i class="fa fa-check-circle indigo-text" title="Developer"></i>
	#end
	<i class="fa fa-dot-circle-o indigo-text" title="$!lang.get('mod')"></i>
#end
#end
#####################################
#macro(setsortbyselection $paramMap $defkey )
#set($sbparam = $request.getParameter("sortby")) #set($sbclazz = "button-tiny-selected" )
#if ($sbparam && !$sbparam.isEmpty()) #set($paramMap[$sbparam] = $sbclazz) #else #set($paramMap[$defkey] = $sbclazz) #end
#end
#####################################
#macro(sectoken $bare)
#if ($!req.getAttribute("_csrf"))#set($sectoken = $!req.getAttribute("_csrf").getToken() )#end
#if ($bare && $bare == true)$!sectoken#else<input type="hidden" name="_csrf" value="$!sectoken"/>#end#end
################# END MACROS ###################################################

